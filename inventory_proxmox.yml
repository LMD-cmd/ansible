# Diese Datei holt automatisch alle Container von Proxmox
plugin: community.proxmox.proxmox
url: "https://10.0.200.97:8006"  # <-- Deine Proxmox-IP anpassen!
validate_certs: false
user: "root@pam"
token_id: "ansible"               # Dein Token-Name von oben
token_secret: "7bf9b58d-7236-4d3a-8b3e-c8e847587e7e"

# WICHTIG: Das hier hat gefehlt!
# Ohne das weiß Ansible nicht, ob ein Container läuft oder nicht.
want_facts: true

# Das verhindert, dass dein Proxmox-Host (pve-01) in der Liste landet
want_proxmox_nodes_ansible_host: false

# Jetzt funktionieren die Filter, weil die "Facts" da sind
# Jetzt funktionieren die Filter, weil die "Facts" da sind
filters:
  - proxmox_status == 'running'
  - proxmox_type == 'lxc'
  # Hier schließen wir die Sonderfälle direkt aus
  - proxmox_name != 'homeassistant'
  - proxmox_name != 'NUT-debian12'

compose:
  ansible_connection: "'community.proxmox.proxmox_pct_remote'"
  ansible_host: "'10.0.200.97'" # <-- Proxmox Node IP
  ansible_user: "'root'"
  ansible_proxmox_vmid: proxmox_vmid